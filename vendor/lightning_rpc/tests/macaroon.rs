extern crate lightning_rpc;

use lightning_rpc::{macaroon::Macaroon, FromFile};

#[test]
fn read_from_file() {
    let macaroon = Macaroon::from_file("./sample/admin.macaroon");
    println!("{:?}", macaroon);
    assert!(macaroon.is_ok())
}

#[test]
fn to_hex() {
    let bytes: Vec<u8> = vec![
        2, 1, 3, 108, 110, 100, 2, 187, 1, 3, 10, 16, 13, 152, 165, 141, 78, 66, 204, 249, 100, 51,
        82, 127, 213, 31, 132, 244, 18, 1, 48, 26, 22, 10, 7, 97, 100, 100, 114, 101, 115, 115, 18,
        4, 114, 101, 97, 100, 18, 5, 119, 114, 105, 116, 101, 26, 19, 10, 4, 105, 110, 102, 111,
        18, 4, 114, 101, 97, 100, 18, 5, 119, 114, 105, 116, 101, 26, 23, 10, 8, 105, 110, 118,
        111, 105, 99, 101, 115, 18, 4, 114, 101, 97, 100, 18, 5, 119, 114, 105, 116, 101, 26, 22,
        10, 7, 109, 101, 115, 115, 97, 103, 101, 18, 4, 114, 101, 97, 100, 18, 5, 119, 114, 105,
        116, 101, 26, 23, 10, 8, 111, 102, 102, 99, 104, 97, 105, 110, 18, 4, 114, 101, 97, 100,
        18, 5, 119, 114, 105, 116, 101, 26, 22, 10, 7, 111, 110, 99, 104, 97, 105, 110, 18, 4, 114,
        101, 97, 100, 18, 5, 119, 114, 105, 116, 101, 26, 20, 10, 5, 112, 101, 101, 114, 115, 18,
        4, 114, 101, 97, 100, 18, 5, 119, 114, 105, 116, 101, 0, 0, 6, 32, 220, 163, 124, 162, 231,
        130, 143, 126, 155, 106, 13, 40, 184, 205, 228, 28, 117, 237, 217, 34, 5, 214, 110, 169,
        183, 231, 22, 156, 250, 113, 141, 133,
    ];
    let macaroon = Macaroon::from(bytes);
    assert_eq!(macaroon.to_hex(), "0201036c6e6402bb01030a100d98a58d4e42ccf96433527fd51f84f41201301a160a0761646472657373120472656164120577726974651a130a04696e666f120472656164120577726974651a170a08696e766f69636573120472656164120577726974651a160a076d657373616765120472656164120577726974651a170a086f6666636861696e120472656164120577726974651a160a076f6e636861696e120472656164120577726974651a140a0570656572731204726561641205777269746500000620dca37ca2e7828f7e9b6a0d28b8cde41c75edd92205d66ea9b7e7169cfa718d85");
}
